@model FarmUp.Dtos.Seller.WeatherForecastDtoList
@using System.Globalization;

@{
    ViewData["Title"] = "สภาพอากาศวันนี้";
    Layout = "~/Views/Shared/_SellerPageLayout_V2.cshtml";
}

<div class="container-fluid" style="background-color:#90CD32;font-family:Sarabun;">
    @{
        var weathernow = Model.weatherForecastDtosList.FirstOrDefault(e => e.DT.Date == DateTime.Now.Date && e.DT.Hour == DateTime.Now.Hour);
        var weatherToday = Model.weatherForecastDtosList.Where(e => e.DT.Date == DateTime.Now.Date && e.DT.TimeOfDay > weathernow.DT.TimeOfDay).ToList();
        //var weatherToday = Model.weatherForecastDtosList ?? new List<FarmUp.Dtos.Seller.WeatherForecastDto>();
    }
    <div class="row">
        <div class ="col-12" style="height:45px"></div>
    </div>
    <div class="row">
        <div class="col-12 text-center">
            <h2 class="fontcustom" style="font-size:20px;">วิเคราะห์สภาพอากาศ</h2>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:20px"></div>
    </div>
    <div class="row">
        <div class="col-12 text-center">
            <h1 class="fontcustom" style="font-size:25px"><b>@Model.District, @Model.Province</b></h1>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:10px"></div>
    </div>
    <div class="row">
        <div class ="col-12">
            <img src="~/assets/images/weather/@weathernow?.Icon" class="img-fluid subboxweather" alt="offer" style="">
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:15px"></div>
    </div>
    <div class="row">
        <div class="col-12 text-center">
            <h1 class="fontcustom" style="font-size:45px"><b>@string.Format("{0}°C",weathernow?.Temp)</b></h1>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:20px"></div>
    </div>
    <div class="row">
        <div class="col-12 text-center">
            <h3 class="fontcustom" >@weathernow?.DisplayTitle</h3>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:15px"></div>
    </div>
    <div class="row">
        <div class="col-12 text-center">
            <h5 class="fontcustom" >@string.Format(@"{0} | {1}",weathernow.DT.ToString("d MMM yyyy", new CultureInfo("th-TH")), weathernow.DT.ToString("HH:mm"))</h5>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:25px"></div>
    </div>
    <div class="row">
        <div class="col-12 center">
            <hr class="center text-center" style="background-color:#FFFFFF;width:95%;margin:auto;"/>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:25px"></div>
    </div>
    <div class="row" style="padding-left:10px;padding-right:10px;">
        <div class="col-6" >
            <div class="col-12 text-center boxcustom verticalcenter" style="width:97%;">
                <div style="height:7px"></div>
                <img src="~/assets/images/weather/Wind.png" class="img-fluid subiconimage" alt="offer">
                <h5 style="padding-top:15px"><b>@weathernow.Wind</b></h5>
                <br />
                <h5 style="margin-top:-20px">แรงลม</h5>
            </div>
        </div>
        <div class="col-6">
            <div class="col-12 text-center boxcustom verticalcenter" style="width:97%;">
                <img src="~/assets/images/weather/Humidity.png" class="img-fluid subiconimage" alt="offer">
                <h5 style="padding-top:15px"><b>@weathernow.Humidity%</b></h5> 
                <br />
                <h5 style="margin-top:-20px">ความชื้น</h5>
            </div>
        </div>
    </div>
    <div class="row">
        <div class ="col-12" style="height:40px"></div>
    </div>
    <div class="row">
        <div class="col-12">
            <h3 class="fontcustom">&nbsp;&nbsp;<b>สภาพอากาศวันนี้ชั่วโมงถัดไป</b></h3>
        </div>
    </div>
    <div class="main-wrap order-detail" style="background-color:#90CD32;padding-left:25px;padding-right:25px;">
    @{
        foreach(var item in weatherToday)
        {
            var dateTimeFormat = string.Format(@"{0} | {1}", item.DT.ToString("d MMM yyyy", new CultureInfo("th-TH")), item.DT.ToString("HH:mm"));
            <div class="row order-box bg2-light boxcustom" >
                <div class="container-fluid">
                    <div class="row">
                        <div class ="col-12" style="height:10px"></div>
                    </div>
                    <div class="row">
                        <div class="col-3">
                            <img src="~/assets/images/weather/@item?.Icon" class="img-fluid subiconimage" alt="offer" style="margin-left:-10px">
                        </div>
                        <div class="col-7 text-left verticalcenter">
                            <h4 style="margin-left:-25px"><b>@item?.DisplayTitle</b></h4>
                            <div style="height:5px"></div>
                            <span style="margin-left:-25px">@dateTimeFormat</span>
                        </div>
                        <div class="col-2 text-center verticalcenter">
                                <h2 style="font-size:30px;margin-left:-30px;"><b>@string.Format("{0}°C",item?.Temp)</b></h2>
                        </div>
                    </div>
                    <div class="row">
                        <div class ="col-12" style="height:20px"></div>
                    </div>
                    <div class="row">
                        <hr />
                    </div>
                    <div class="row">
                        <div class="col-6 text-center">
                            <div style="height:7px"></div>
                            <img src="~/assets/images/weather/Wind.png" class="img-fluid subiconimage" alt="offer">
                            <h5 style="padding-top:10px"><b>@item.Wind</b></h5>
                            <br />
                            <h5 style="margin-top:-20px">แรงลม</h5>
                        </div>
                        <div class="col-6 text-center">
                            <img src="~/assets/images/weather/Humidity.png" class="img-fluid subiconimage" alt="offer">
                            <h5 style="padding-top:10px"><b>@item.Humidity%</b></h5> 
                            <br />
                            <h5 style="margin-top:-20px">ความชื้น</h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12" style="height:5px"></div>
                    </div>
                </div>
            </div>
        }
    }
        <div style="height:40px"></div>
    </div>
</div>

@*<!-- Skeleton loader Start -->
<div>
    <!-- Header Start -->
    <header class="header">
        <div class="logo-wrap">
            <a href="index.html" style="visibility:hidden"><i class="iconly-Arrow-Left-Square icli"></i></a>
            <h1 class="title-color font-md" style="visibility:hidden">รายการต้องทำ</h1>
        </div>
        <div class="avatar-wrap">
            <a href="index.html" style="visibility:hidden">
                <i class="iconly-Home icli"></i>
            </a>
        </div>
    </header>
    <!-- Header End -->
    <!-- Main Start -->
    <div class="main-wrap order-detail mb-xxl">
        <!-- Banner Start -->
        <div class="">
            <div class="banner-box">
                <div class="media">
                    <div class="img"></div>
                    <div class="media-body">
                        <h2>คาดการณ์สภาาพอากาศ : @Model.District, @Model.Province</h2>
                        <span class="font-sm title-color fw-600">&nbsp;</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- Banner End -->
        <section class="offer-section pb-0">
            <div class="offer">
                <div class="offer-wrap">
                    
                    @{ var isPrintToday = false; }
                    @if(Model.weatherForecastDtosList.Count == 0)
                    {
                        <div class="product-list media">
                        <div class="media-body">
                            <span class="font-sm title-color fw-600"> ระบบกำลังตรวจสอบที่อยู่ของคุณ โปรดรอประมาณ 10 นาทีเพื่อใช้ในการตรวจสอบ</span>
                        </div>
                        </div>
                    }
                    else
                    {
                        @foreach(var WeatherItem in Model.weatherForecastDtosList){
                            if (WeatherItem.DT < DateTime.Now.AddHours(-1) || WeatherItem.DT > DateTime.Now.AddDays(1).AddHours(1))
                                continue;
                            @if (!isPrintToday)
                            {
                                isPrintToday = true;
                                <h3 style="padding: 10px;">วันนี้</h3>
                            }
                            else if(WeatherItem.DT.ToString("MM-dd HH").Equals(DateTime.Now.AddDays(1).ToString("MM-dd 00")))
                            {
                                <h3 style="padding: 20px 10px 5px 10px;">พรุ่งนี้</h3>
                            }
                            <div class="product-list media">
                                <img src="~/assets/images/weather/@WeatherItem.Icon" class="img-fluid" alt="offer" style="width:60px">
                                <div class="media-body">
                                    <span class="font-sm title-color fw-600"> @WeatherItem.DT.ToString("HH:mm") คาดว่า @WeatherItem.DisplayTitle, อุณหภูมิ @WeatherItem.Temp°C</span>
                                    <span class="content-color font-sm">ความชื้น @WeatherItem.Humidity%, แรงลม @WeatherItem.Wind</span>
                                </div>
                            </div>
                        }
                    }

                    <div class="product-list media">
                        <img src="~/assets/images/weather/sun.png" class="img-fluid" alt="offer">
                        <div class="media-body">
                            <span class="font-sm title-color fw-600"> 0:00 โอกาสเกิดฝน 10%, อุณหภูมิ 26°C</span>
                            <span class="content-color font-sm">ความชื้น 20%, แรงลม 5 กม/ช</span>
                            <span class="content-color font-sm">เมฆมาก, UV 1/10</span>
                        </div>
                    </div>
                    <div class="product-list media">
                        <img src="~/assets/images/weather/moon.png" class="img-fluid" alt="offer">
                        <div class="media-body">
                            <span class="font-sm title-color fw-600"> 0:00 โอกาสเกิดฝน 20%, อุณหภูมิ 32°C</span>
                            <span class="content-color font-sm">ความชื้น 20%, แรงลม 5 กม/ช</span>
                            <span class="content-color font-sm">เมฆมาก, UV 1/10</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- Main End -->
</div>
<!-- Skeleton loader End -->*@